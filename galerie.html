<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <title>Galerie photo — Yingying HOU</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="Galerie officielle de photos de Yingying HOU. Photos de studio, tournages et portraits HD." />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/css/styles.css" />
</head>
<body>
  <a class="skip" href="#main">Aller au contenu</a>

  <header class="site-header">
    <div class="wrap">
      <a class="brand" href="/">Yingying <strong>HOU</strong></a>
      <button class="nav-toggle" aria-expanded="false" aria-controls="nav">Menu</button>
      <nav id="nav" class="site-nav">
        <ul>
          <li><a href="/">Accueil</a></li>
          <li><a href="/filmographie.html">Filmographie</a></li>
          <li class="active"><a href="/galerie.html" aria-current="page">Galerie</a></li>
          <li><a href="/contact.html">Contact / Booking</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <main id="main">
    <section class="page-hero">
      <div class="wrap">
        <h1>Galerie Photo</h1>
        <p class="kicker">Portraits studio, photos de tournage et festivals.</p>
      </div>
    </section>

    <section class="wrap pad">
  <div class="gallery-grid" id="gallery">
    </div>
</section>

    <div id="lightbox" class="lightbox" role="dialog" aria-modal="true" aria-hidden="true">
      <button class="lb-close" aria-label="Fermer">✕</button>
      <button class="lb-prev" aria-label="Précédent">‹</button>
      <figure class="lb-figure">
        <img id="lb-image" src="" alt="">
        <figcaption id="lb-caption"></figcaption>
      </figure>
      <button class="lb-next" aria-label="Suivant">›</button>
    </div>
  </main>

  <footer class="site-footer">
    <div class="wrap">
      <p>© <span id="year"></span> Yingying HOU. Powered by NOCX WEB. Tous droits réservés.</p>
      <nav><a href="/legal.html">Mentions légales</a> <a href="/privacy.html">Confidentialité</a></nav>
    </div>
  </footer>
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.1/firebase-app.js";
    import { getFirestore, collection, getDocs, query, orderBy } from "https://www.gstatic.com/firebasejs/10.8.1/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyD_Yvi_u5WixeTxuuEORgwFtxksAm7OUY4",
      authDomain: "kukyying-f1c95.firebaseapp.com",
      projectId: "kukyying-f1c95",
      storageBucket: "kukyying-f1c95.firebasestorage.app",
      messagingSenderId: "681899915263",
      appId: "1:681899915263:web:4d64dcf4a9c57748ead9ca"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    async function chargerGalerie() {
      // ⚠️ Note : Ton HTML utilise id="gallery"
      const conteneurGalerie = document.getElementById('gallery');
      const lightbox = document.getElementById('lightbox');
      const lbImage = document.getElementById('lb-image');
      const lbCaption = document.getElementById('lb-caption');

      let photos = [];
      let indexActuel = 0;

      try {
        // On demande à Firebase de trier par "ordre" directement
        const q = query(collection(db, "galerie"), orderBy("ordre", "asc"));
        const snapshot = await getDocs(q);
        
        if (!snapshot.empty) {
          conteneurGalerie.innerHTML = ""; 
          
          snapshot.forEach((doc) => {
            const data = doc.data();
            photos.push(data);

            const item = document.createElement('a');
            item.href = "#";
            item.className = "gallery-item";
            item.innerHTML = `
              <img src="${data.url}" alt="${data.caption || 'Photo Yingying HOU'}" loading="lazy">
              <div class="item-overlay"><span>Agrandir</span></div>
            `;
            
            item.onclick = (e) => {
              e.preventDefault();
              afficherPhoto(photos.indexOf(data));
            };
            
            conteneurGalerie.appendChild(item);
          });

          const afficherPhoto = (index) => {
            indexActuel = index;
            lbImage.src = photos[index].url;
            lbCaption.textContent = photos[index].caption || "";
            lightbox.setAttribute('aria-hidden', 'false');
          };

          // Navigation Lightbox
          lightbox.querySelector('.lb-close').onclick = () => lightbox.setAttribute('aria-hidden', 'true');
          lightbox.querySelector('.lb-next').onclick = () => afficherPhoto((indexActuel + 1) % photos.length);
          lightbox.querySelector('.lb-prev').onclick = () => afficherPhoto((indexActuel - 1 + photos.length) % photos.length);

        } else {
          conteneurGalerie.innerHTML = "<p>Aucune photo trouvée.</p>";
        }
      } catch (erreur) {
        console.error("Erreur :", erreur);
        conteneurGalerie.innerHTML = "<p>Erreur de chargement.</p>";
      }
    }
    
    chargerGalerie();
  </script>
  <script src="/js/main.js" defer></script>
</body>
</html>
